{{ define "main" }}
{{ $data := site.Data.collections }}
{{ $collections := $data.collections }}

<section class="hero wrap">
  <p class="kicker">IIIF Digital Exhibit</p>
  <h1>{{ .Title }}</h1>
  <p class="lead">{{ $data.site.description }} All images are served via the <a href="https://iiif.io" target="_blank" rel="noopener">IIIF Image API</a>.</p>
</section>

<section class="overview wrap">
  <div class="section-title">
    <h2>Collections Overview</h2>
    <p>{{ len $collections }} collections</p>
  </div>
  <div class="breakdown-grid">
    <div class="panel">
      <h3>What You'll Find</h3>
      <ul class="count-list">
        <li><span>Photographs &amp; Images</span><span>Thousands</span></li>
        <li><span>Sheet Music &amp; Documents</span><span>Hundreds</span></li>
        <li><span>Historical Posters</span><span>200+</span></li>
        <li><span>Time Span</span><span>1880s - Present</span></li>
      </ul>
    </div>
    <div class="panel">
      <h3>Subject Areas</h3>
      <ul class="count-list">
        <li><span>Philadelphia History</span></li>
        <li><span>African American Culture</span></li>
        <li><span>Performing Arts</span></li>
        <li><span>Transportation</span></li>
        <li><span>University Archives</span></li>
        <li><span>Civil Rights</span></li>
      </ul>
    </div>
  </div>
</section>

<section class="collections-browse wrap">
  <div class="section-title">
    <h2>Browse Collections</h2>
    <p>Select a collection to explore its items</p>
  </div>
  <div class="collection-grid">
    {{ $collectionPages := where site.RegularPages "Section" "collections" }}
    {{ range $index, $page := $collectionPages }}
      {{/* Find matching data for this collection page */}}
      {{ $collId := $page.Params.collection_id }}
      {{ $collData := false }}
      {{ range $collections }}
        {{ if eq .id $collId }}
          {{ $collData = . }}
        {{ end }}
      {{ end }}
      {{ if $collData }}
        {{ $previewItem := index $collData.items 0 }}
        {{ $image := partial "iiif-image.html" $previewItem }}
        <a class="collection-card reveal" href="{{ $page.RelPermalink }}" style="--delay: {{ mul $index 0.06 }}s;">
          <div class="collection-card-image">
            <img src="{{ $image }}" alt="{{ $collData.title }}" loading="lazy" decoding="async" />
          </div>
          <div class="collection-card-body">
            <h3>{{ $collData.title }}</h3>
            <p class="meta">{{ len $collData.items }} featured items</p>
            <p class="summary">{{ $collData.description | truncate 160 }}</p>
          </div>
        </a>
      {{ end }}
    {{ end }}
  </div>
</section>

<section class="cta wrap">
  <div class="cta-card">
    <div>
      <h2>Explore More at Temple</h2>
      <p>These curated selections represent just a fraction of the digital resources available. Visit the <a href="{{ $data.site.url }}" target="_blank" rel="noopener">full digital collections portal</a> to discover over 50 collections spanning Philadelphia history, African American heritage, university archives, and more.</p>
    </div>
  </div>
</section>
{{ end }}
