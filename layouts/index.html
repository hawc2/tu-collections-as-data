{{ define "main" }}
{{ $data := site.Data.collections }}
{{ $collections := $data.collections }}

<section class="hero hero--home wrap">
  <p class="kicker">Exploratory Dashboard</p>
  <h1>Collections as Data</h1>
  <p class="lead">{{ $data.site.description }} <br><br>All item images and data analyzed on this site are served via the
    <a href="https://iiif.io" target="_blank" rel="noopener">IIIF Image API</a>.</p>
</section>

<section class="overview wrap">
  <div class="section-title">
    <h2>The Big Picture</h2>
    <p>Scaling our Cultural Heritage</p>
  </div>
  <div class="breakdown-grid">
    <div class="panel"
      style="grid-column: 1 / -1; background: var(--cherry); color: white; border: none; padding: 40px; border-radius: 16px;">
      <div style="display: flex; justify-content: space-around; text-align: center; flex-wrap: wrap; gap: 30px;">
        <div>
          <div style="font-size: 3.5rem; font-weight: 800; font-family: var(--serif); line-height: 1;">{{ len $collections }}</div>
          <div
            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9; margin-top: 10px;">
            Curated Collections Visualized</div>
        </div>
        <div>
          {{ $trainItems := len site.Data.trains.items }}
          {{ $danceItems := len site.Data.dance.items }}
          {{ $posterItems := len site.Data.posters.items }}
          {{ $featuredItems := 0 }}{{ range $collections }}{{ $featuredItems = add $featuredItems (len .items) }}{{ end }}
          {{ $totalAnalyzed := add (add (add $trainItems $featuredItems) $danceItems) $posterItems }}
          <div style="font-size: 3.5rem; font-weight: 800; font-family: var(--serif); line-height: 1;">{{ lang.FormatNumber 0 $totalAnalyzed }}</div>
          <div
            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9; margin-top: 10px;">
            Items Analyzed in Set</div>
        </div>
        <div>
          <div style="font-size: 3.5rem; font-weight: 800; font-family: var(--serif); line-height: 1;">~500K</div>
          <div
            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9; margin-top: 10px;">
            Total Archival Items Online</div>
        </div>
        <div>
          <div style="font-size: 3.5rem; font-weight: 800; font-family: var(--serif); line-height: 1;">&lt; 1%</div>
          <div
            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9; margin-top: 10px;">
            of Temple's Assets Sampled Here</div>
        </div>
      </div>
    </div>

    <div class="panel">
      <h3>Temporal Reach</h3>
      <p style="color: var(--muted); font-size: 0.95rem;">The collections sampled span from the <strong>1880s to the
          present day</strong>, allowing us to build timelines mapping public recreation, wartime propaganda, and civil
        rights mobilization.</p>
    </div>
    <div class="panel">
      <h3>Geospatial Footprint</h3>
      <p style="color: var(--muted); font-size: 0.95rem;">While rooted in <strong>Philadelphia History</strong>, we
        extract coordinates from these items to reveal the global geographic footprint of our local archives.</p>
    </div>
  </div>
</section>

<section id="collections" class="collections-browse wrap">
  <div class="section-title">
    <h2>Browse Collections</h2>
    <p>Select a collection to explore its items</p>
  </div>
  <div class="collection-grid">
    {{ $collectionPages := where site.RegularPages "Section" "collections" }}
    {{ range $index, $page := $collectionPages }}
    {{/* Find matching data for this collection page */}}
    {{ $collId := $page.Params.collection_id }}
    {{ $collData := false }}
    {{ range $collections }}
    {{ if eq .id $collId }}
    {{ $collData = . }}
    {{ end }}
    {{ end }}
    {{ if $collData }}
    {{ $previewItem := index $collData.items 0 }}
    {{ $image := partial "iiif-image.html" $previewItem }}
    <a class="collection-card reveal" href="{{ $page.RelPermalink }}" style="--delay: {{ mul $index 0.06 }}s;">
      <div class="collection-card-image">
        <img src="{{ $image }}" alt="{{ $collData.title }}" loading="lazy" decoding="async" />
      </div>
      <div class="collection-card-body">
        <h3>{{ $collData.title }}</h3>
        <p class="meta">{{ len $collData.items }} featured items</p>
        <p class="summary">{{ $collData.description | truncate 160 }}</p>
      </div>
    </a>
    {{ end }}
    {{ end }}
  </div>
</section>

<section id="exhibits" class="collections-browse wrap">
  <div class="section-title">
    <h2>Browse Exhibits</h2>
    <p>Thematic exhibits exploring items across Temple's digital collections</p>
  </div>
  <div class="collection-grid">
    {{ $trainData := site.Data.trains.items }}
    {{ $trainFirst := index $trainData 0 }}
    {{ $trainImage := partial "iiif-image.html" $trainFirst }}
    <a class="collection-card reveal" href="{{ "trains/" | relURL }}" style="--delay: 0s;">
      <div class="collection-card-image">
        <img src="{{ $trainImage }}" alt="Trains at Temple" loading="lazy" decoding="async" />
      </div>
      <div class="collection-card-body">
        <h3>Trains at Temple</h3>
        <p class="meta">{{ len $trainData }} photographs</p>
        <p class="summary">Train and railroad imagery drawn from Temple University Libraries' digital collections.</p>
      </div>
    </a>

    {{ $danceData := site.Data.dance.items }}
    {{ $danceFirst := index $danceData 0 }}
    {{ $danceImage := partial "iiif-image.html" $danceFirst }}
    <a class="collection-card reveal" href="{{ "dance/" | relURL }}" style="--delay: 0.06s;">
      <div class="collection-card-image">
        <img src="{{ $danceImage }}" alt="Philadelphia Dance Collection" loading="lazy" decoding="async" />
      </div>
      <div class="collection-card-body">
        <h3>Philadelphia Dance Collection</h3>
        <p class="meta">{{ len $danceData }} photographs</p>
        <p class="summary">Photographs spanning classical ballet, modern dance, and African American dance traditions.</p>
      </div>
    </a>

    {{ $posterData := site.Data.posters.items }}
    {{ $posterFirst := index $posterData 0 }}
    {{ $posterImage := partial "iiif-image.html" $posterFirst }}
    <a class="collection-card reveal" href="{{ "propaganda/" | relURL }}" style="--delay: 0.12s;">
      <div class="collection-card-image">
        <img src="{{ $posterImage }}" alt="WWI War Posters" loading="lazy" decoding="async" />
      </div>
      <div class="collection-card-body">
        <h3>WWI War Posters</h3>
        <p class="meta">{{ len $posterData }} posters</p>
        <p class="summary">Allied Posters of World War I exploring recruitment, propaganda, war bonds, and the home front.</p>
      </div>
    </a>
  </div>
</section>

<section class="cta wrap">
  <div class="cta-card">
    <div>
      <h2>Explore the full archives</h2>
      <p>This site serves as an exploratory proof-of-concept for data visualization. To browse the definitive
        collections, perform deep searches, and view un-curated materials, visit the <a href="{{ $data.site.url }}"
          target="_blank" rel="noopener">Temple University Digital Collections portal</a>.</p>
    </div>
  </div>
</section>
{{ end }}